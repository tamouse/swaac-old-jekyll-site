<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Software as a Craft</title>
    <description>The development blog of tamouse</description>
    <link>http://swaac.tamouse.org/</link>
    <atom:link href="http://swaac.tamouse.org/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Wed, 10 May 2017 10:18:20 -0500</pubDate>
    <lastBuildDate>Wed, 10 May 2017 10:18:20 -0500</lastBuildDate>
    <generator>Jekyll v3.4.3</generator>
    
      <item>
        <title>Postgresql Timestamp Accuracy and Precision</title>
        <description>&lt;p&gt;Today at work, a question came up whether one could count on the last
inserted item in a table to have the most recent value for the
&lt;code class=&quot;highlighter-rouge&quot;&gt;created_at&lt;/code&gt; timestamp, so I went looking.&lt;/p&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#rtfm&quot; id=&quot;markdown-toc-rtfm&quot;&gt;RTFM&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#factorygirl-insert&quot; id=&quot;markdown-toc-factorygirl-insert&quot;&gt;FactoryGirl insert&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#create-multiple-records&quot; id=&quot;markdown-toc-create-multiple-records&quot;&gt;Create multiple records&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#sql-insert-with-date-formatting&quot; id=&quot;markdown-toc-sql-insert-with-date-formatting&quot;&gt;SQL Insert with date formatting&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#forgetting-the-milliseconds-ooops&quot; id=&quot;markdown-toc-forgetting-the-milliseconds-ooops&quot;&gt;Forgetting the milliseconds: Ooops&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#sql-now-function&quot; id=&quot;markdown-toc-sql-now-function&quot;&gt;SQL &lt;code class=&quot;highlighter-rouge&quot;&gt;now()&lt;/code&gt; function&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#single-insert-statement-multiple-values-with-now&quot; id=&quot;markdown-toc-single-insert-statement-multiple-values-with-now&quot;&gt;Single insert statement, multiple values with &lt;code class=&quot;highlighter-rouge&quot;&gt;now()&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#conclusion&quot; id=&quot;markdown-toc-conclusion&quot;&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;rtfm&quot;&gt;RTFM&lt;/h2&gt;

&lt;p&gt;The
&lt;a href=&quot;https://www.postgresql.org/docs/9.6/static/index.html&quot;&gt;postgresql documentation&lt;/a&gt; for
&lt;a href=&quot;https://www.postgresql.org/docs/9.6/static/datatype-datetime.html&quot;&gt;Date / Time Types&lt;/a&gt; shows
the resolution as 14 digits and 1 microsecond.&lt;/p&gt;

&lt;h2 id=&quot;factorygirl-insert&quot;&gt;FactoryGirl insert&lt;/h2&gt;

&lt;p&gt;I ran a small experiment where I first used &lt;code class=&quot;highlighter-rouge&quot;&gt;FactoryGirl&lt;/code&gt; to insert 50
records. These showed only increasing timestamps showing there’s
enough resolution at a microsecond to distinguish insertion order
accurately building and inserting objects with FG.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;created_at&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;posts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;created_at&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-----+----------------------------&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;453&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;065175&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;454&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;074039&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;455&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;077969&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;456&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;08049&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;create-multiple-records&quot;&gt;Create multiple records&lt;/h2&gt;

&lt;p&gt;Next I tried it by creating an array of new values and passing it to
the &lt;code class=&quot;highlighter-rouge&quot;&gt;.create&lt;/code&gt; method of the Model. This also showed plenty of
resolution where none of them would be considdred a “tie” when
ordering.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;created_at&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;posts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;created_at&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-----+----------------------------&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;553&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;415659&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;554&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;432941&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;555&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;436157&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;556&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;437815&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;557&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;439465&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;sql-insert-with-date-formatting&quot;&gt;SQL Insert with date formatting&lt;/h2&gt;

&lt;p&gt;One of the things Rails is poor at is mass uploading. In the past I’ve
used techniques to get around this. So giving that a go, I built a set
of insert statements that used rails’s &lt;code class=&quot;highlighter-rouge&quot;&gt;DateTime.now&lt;/code&gt; to generate the
timestamp.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;OpenStruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;content: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Faker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Lorem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;created_at: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;DateTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;updated_at: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;DateTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;now&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Then made that into an SQL statement.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&quot;insert into posts (content, created_at, updated_at) &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&quot;values ('&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;', '&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strftime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%FT%T.%6N%Z&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;', &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&quot;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strftime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%FT%T.%6N%Z&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;' ); &quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This gave the same result of increasing timestamps.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;created_at&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;posts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;created_at&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-----+----------------------------&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;603&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;09&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;038286&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;604&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;09&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;038382&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;605&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;09&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;038421&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;606&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;09&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;038455&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;607&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;09&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;29&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;038484&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;forgetting-the-milliseconds-ooops&quot;&gt;Forgetting the milliseconds: Ooops&lt;/h3&gt;

&lt;p&gt;Note that if the milliseconds are not included in the &lt;code class=&quot;highlighter-rouge&quot;&gt;strftime&lt;/code&gt;
method above, then it is quite possible to insert timestamps that look
the same.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&quot;insert into posts (content, created_at, updated_at) &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&quot;values ('&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;', '&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strftime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%FT%T%Z&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;', &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&quot;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strftime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;%FT%T%Z&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;' ); &quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Oops:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;created_at&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;posts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;created_at&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-----+---------------------&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;703&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;09&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;57&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;704&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;09&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;57&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;705&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;09&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;57&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;706&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;09&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;57&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;sql-now-function&quot;&gt;SQL &lt;code class=&quot;highlighter-rouge&quot;&gt;now()&lt;/code&gt; function&lt;/h2&gt;

&lt;p&gt;Next, I build an SQL query using the &lt;code class=&quot;highlighter-rouge&quot;&gt;now()&lt;/code&gt; method for each new
record.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;created_at&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;posts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;created_at&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;-----+----------------------------&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;653&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;252631&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;654&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;252631&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;655&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;252631&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;656&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;252631&lt;/span&gt;
 &lt;span class=&quot;mi&quot;&gt;657&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2017&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;252631&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Here we can see that every value inserted got the same
timestamp. Conclusion that Postgresql calculates &lt;code class=&quot;highlighter-rouge&quot;&gt;now()&lt;/code&gt; once in
compiling the insert statement.&lt;/p&gt;

&lt;h2 id=&quot;single-insert-statement-multiple-values-with-now&quot;&gt;Single insert statement, multiple values with &lt;code class=&quot;highlighter-rouge&quot;&gt;now()&lt;/code&gt;&lt;/h2&gt;

&lt;p&gt;Final check, using a single &lt;code class=&quot;highlighter-rouge&quot;&gt;insert into&lt;/code&gt; statement with
multiple values.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span class=&quot;k&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;into&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;posts&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;created_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;updated_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;values&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Aut exercitationem harum molestiae.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()),&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Aliquid sit et distinctio quidem minima ut.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()),&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Officiis dolores cupiditate aut sit.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;(only for 100 items.)&lt;/p&gt;

&lt;p&gt;This gives the same result as the previous, as expected.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;select id,created_at from posts;
 id  |         created_at
-----+----------------------------
 353 | 2017-05-10 03:04:59.684801
 354 | 2017-05-10 03:04:59.684801
 355 | 2017-05-10 03:04:59.684801
 356 | 2017-05-10 03:04:59.684801
 357 | 2017-05-10 03:04:59.684801&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;So it seems as though one might not be able to count on inserted
values having an increasing &lt;code class=&quot;highlighter-rouge&quot;&gt;created_at&lt;/code&gt; value, but this won’t come up
very often in a Rails app unless you’re doing mass-inserts like the
above.&lt;/p&gt;
</description>
        <pubDate>Tue, 09 May 2017 21:31:00 -0500</pubDate>
        <link>http://swaac.tamouse.org/postgresql/2017/05/09/postgresql-timestamp-accuracy/</link>
        <guid isPermaLink="true">http://swaac.tamouse.org/postgresql/2017/05/09/postgresql-timestamp-accuracy/</guid>
        
        <category>postgresql</category>
        
        <category>databases</category>
        
        <category>timestamps</category>
        
        <category>test</category>
        
        
        <category>postgresql</category>
        
      </item>
    
      <item>
        <title>Notes on using ActionMailer in Rails</title>
        <description>&lt;p&gt;(This article was originally posted on Sat Aug 24 10:39:09 2013 in
wiki.tamaratemple.com. It deserves a new home.)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://guides.rubyonrails.org/action_mailer_basics.html&quot;&gt;ActionMailer&lt;/a&gt; allows
a Rails application to send and receive emails in a fashion similar to
a Rails controller. You can have multi-part bodies, templates,
attachments, and so on. It isn’t quite a complete ecosystem, as you
need to have a transport for sending and recieving mail, and you need
to have a way of accurately testing your emails, so I’m going to write
some notes to complete that view.&lt;/p&gt;

&lt;h2 id=&quot;first-read-the-documentation&quot;&gt;First, read the documentation&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://guides.rubyonrails.org/&quot;&gt;The Rails Guides&lt;/a&gt; provide the
basics for getting up and running using ActionMailer.&lt;/p&gt;

&lt;p&gt;In addition,
the
&lt;a href=&quot;http://api.rubyonrails.org/classes/ActionMailer/Base.html&quot;&gt;api docs&lt;/a&gt;
provides more details on the usage of the methods in ActionMailer.&lt;/p&gt;

&lt;h2 id=&quot;testing-considerations&quot;&gt;Testing Considerations&lt;/h2&gt;

&lt;p&gt;Since we are all good TDD/BDD-ers (we are, right?), I’m going to start
with how you can set up your Rails environment for testing your
mailers.&lt;/p&gt;

&lt;p&gt;The Rails Guides provide a section
on
&lt;a href=&quot;http://guides.rubyonrails.org/testing.html#testing-your-mailers&quot;&gt;testing your mailers&lt;/a&gt;,
which you should go off and read right now.&lt;/p&gt;

&lt;h3 id=&quot;delivery-mode-test&quot;&gt;Delivery Mode &lt;code class=&quot;highlighter-rouge&quot;&gt;:test&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;The simplest setup for this, especially useful for unit and functional
testing, is to set the delivery mode for action mailer to &lt;code class=&quot;highlighter-rouge&quot;&gt;:test&lt;/code&gt; in
the &lt;code class=&quot;highlighter-rouge&quot;&gt;test&lt;/code&gt; environment.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;File:&lt;/strong&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;config/environments/test.rb&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;  &lt;span class=&quot;c1&quot;&gt;# Tell Action Mailer not to deliver emails to the real world.&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# The :test delivery method accumulates sent emails in the&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# ActionMailer::Base.deliveries array.&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;action_mailer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;delivery_method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:test&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In a new Rails app, this is the default setting, so you don’t really
need to do anything in particular.&lt;/p&gt;

&lt;h3 id=&quot;mailcatcher-for-round-trip-testing&quot;&gt;MailCatcher For Round-Trip Testing&lt;/h3&gt;

&lt;p&gt;While it is often the case that you should not bother to test the
underlying delivery mechanisms, sometimes you really want to see what
your email is going to look like in the eyes of the
receiver. &lt;a href=&quot;http://mailcatcher.me/&quot;&gt;MailCatcher&lt;/a&gt; to the
rescue. MailCatcher is a nice utility that emulates an SMTP
connection and provides a webmail view of the mails it catches. To use
MailCatcher, after you’ve installed it according to the instructions,
is to set up your environments files appropriately. In this case, I’m
going to set it in the &lt;code class=&quot;highlighter-rouge&quot;&gt;development&lt;/code&gt; environment.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;File:&lt;/strong&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;config/environments/development.rb&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;action_mailer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;deliver_method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:smtp&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;action_mailer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;smtp_settings&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;:address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'localhost'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;:port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1025&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;When you cause mails to be sent with your mailer, the mails can be
seen by pointing your browser at &lt;a href=&quot;http://localhost:1080&quot;&gt;http://localhost:1080&lt;/a&gt; and it
works like your typical web mail reader. (You can’t reply or forward,
obviously.)&lt;/p&gt;

&lt;h2 id=&quot;intercepting-emails-on-staging&quot;&gt;Intercepting Emails on Staging&lt;/h2&gt;

&lt;p&gt;When getting ready to deploy a project update, generally a good
practice is to deploy to a staging server that mirrors your production
environment as closely as possible to see if there will be any errors
during final deploy. One of the things frequently done in this is a
run with a copy (or near copy) of production data.&lt;/p&gt;

&lt;p&gt;However, you probably don’t want mail going out indiscrimantly from
your staging environment to your users, so the thing you want to do
here is intercept the emails. You can set up mailcatcher like above,
but there are alternatives, such as catching all mail and switch the
outbound addresses to something more benign.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://guides.rubyonrails.org/action_mailer_basics.html#intercepting-emails&quot;&gt;Someone thought this through already&lt;/a&gt;
The example works perfectly for what I need to be able to do full
systems testing on staging without worrying about sending bogus
emails to users!&lt;/p&gt;
</description>
        <pubDate>Sat, 06 May 2017 03:54:00 -0500</pubDate>
        <link>http://swaac.tamouse.org/rails/2017/05/06/notes-on-using-actionmailer-in-rails/</link>
        <guid isPermaLink="true">http://swaac.tamouse.org/rails/2017/05/06/notes-on-using-actionmailer-in-rails/</guid>
        
        <category>rails</category>
        
        <category>ruby</category>
        
        <category>actionmailer</category>
        
        
        <category>rails</category>
        
      </item>
    
      <item>
        <title>Playing with Grid and Flexbox</title>
        <description>&lt;p&gt;So last month, March 2017, Grid CSS support dropped for almost all the
major browsers. Grid is a pretty nice system for 2-dimensional layout
while Flexbox remains a good system for 1-dimensional layout. A lot of
folks have been
asking &lt;a href=&quot;https://css-tricks.com/css-grid-replace-flexbox/&quot; title=&quot;No. Well, mostly no.&quot;&gt;if Grid replaces Flexbox but it does not&lt;/a&gt;. In
fact, they can play really well together.&lt;/p&gt;

&lt;h2 id=&quot;gridcss-holy-grail-layout&quot;&gt;GridCSS Holy Grail Layout&lt;/h2&gt;

&lt;p&gt;The [holy grail] layout is a pretty common one, seen pretty much
everywhere:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;header and footer&lt;/li&gt;
  &lt;li&gt;middle content area with left and right sidebars&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Creating it in Grid was something I wanted to try to figure out as a
way of learning. My attempt is over on CodePen.io:&lt;/p&gt;

&lt;p data-height=&quot;265&quot; data-theme-id=&quot;0&quot; data-slug-hash=&quot;zwwwwZ&quot; data-default-tab=&quot;result&quot; data-user=&quot;tamouse&quot; data-embed-version=&quot;2&quot; data-pen-title=&quot;GridCSS holy grail&quot; class=&quot;codepen&quot;&gt;See the Pen &lt;a href=&quot;http://codepen.io/tamouse/pen/zwwwwZ/&quot;&gt;GridCSS holy grail&lt;/a&gt; by Tamara Temple (&lt;a href=&quot;http://codepen.io/tamouse&quot;&gt;@tamouse&lt;/a&gt;) on &lt;a href=&quot;http://codepen.io&quot;&gt;CodePen&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I’m still struggling with getting the height to stretch out if the
content does not naturally fill the window.&lt;/p&gt;

&lt;h2 id=&quot;flexbox-dashboard-with-grid-section&quot;&gt;Flexbox Dashboard with Grid Section&lt;/h2&gt;

&lt;p&gt;This was more successful. I wanted a full-height left navigation panel
and a masonry-style right panel that would let various guages and
displays flow nicely.&lt;/p&gt;

&lt;p data-height=&quot;265&quot; data-theme-id=&quot;0&quot; data-slug-hash=&quot;EmmXdr&quot; data-default-tab=&quot;result&quot; data-user=&quot;tamouse&quot; data-embed-version=&quot;2&quot; data-pen-title=&quot;Flexbox Dashboard with Grid Section&quot; class=&quot;codepen&quot;&gt;See the Pen &lt;a href=&quot;http://codepen.io/tamouse/pen/EmmXdr/&quot;&gt;Flexbox Dashboard with Grid Section&lt;/a&gt; by Tamara Temple (&lt;a href=&quot;http://codepen.io/tamouse&quot;&gt;@tamouse&lt;/a&gt;) on &lt;a href=&quot;http://codepen.io&quot;&gt;CodePen&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;It’s not really responsive, I’d like it if the left panel shrunk down
when the viewport gets narrow enough, but I don’t think I can make
that happen on codepen.&lt;/p&gt;

&lt;h2 id=&quot;links&quot;&gt;Links&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://codepen.io/tamouse/pen/zwwwwZ&quot; title=&quot;GridCSS holy grail&quot;&gt;GridCSS Holy Grail&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;http://codepen.io/tamouse/pen/EmmXdr&quot; title=&quot;Flex Dashboard with Grid Section&quot;&gt;Flexbox Dashboard&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://css-tricks.com/css-grid-replace-flexbox/&quot; title=&quot;No. Well, mostly no.&quot;&gt;Grid vs. Flexbox&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=tjHOLtouElA&quot; title=&quot;Rachel Andrew Presentation: Start Using Grid Today&quot;&gt;Rachel Andrew’s Start using grid today (video)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://hackernoon.com/getting-started-with-css-grid-layout-8e00de547daf&quot; title=&quot;Hackernoon: Getting started with Grid Layout&quot;&gt;Getting started with CSS Grid&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://css-tricks.com/css-grid-one-layout-multiple-ways/&quot; title=&quot;One layout, Multiple Ways in CSS Grid&quot;&gt;One Layout, Multiple Ways&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;script async=&quot;&quot; src=&quot;https://production-assets.codepen.io/assets/embed/ei.js&quot;&gt;&lt;/script&gt;

</description>
        <pubDate>Tue, 02 May 2017 17:00:00 -0500</pubDate>
        <link>http://swaac.tamouse.org/css/2017/05/02/playing-with-grid-and-flexbox/</link>
        <guid isPermaLink="true">http://swaac.tamouse.org/css/2017/05/02/playing-with-grid-and-flexbox/</guid>
        
        <category>css</category>
        
        <category>grid</category>
        
        <category>flexbox</category>
        
        
        <category>css</category>
        
      </item>
    
      <item>
        <title>Changing the Location for Screencaptures on macOS</title>
        <description>&lt;p&gt;Something I had tucked away in notes on a different computer while I
was working on my work computer, so I figured it was time to put up on
the SWaaC blog.&lt;/p&gt;

&lt;p&gt;By default on macOS, when you do a screen capture, it saves the
file(s) in your Desktop directory. I’d like to put them someplace else
as I really hate having cluttered up desktops.&lt;/p&gt;

&lt;p&gt;The command to use from the Terminal is &lt;code class=&quot;highlighter-rouge&quot;&gt;defaults&lt;/code&gt; which is used to
set various system parameters that aren’t available in Systems
Preferences.&lt;/p&gt;

&lt;p&gt;Here’s what I did:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;mkdir ~/Pictures/Screenshots
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;defaults write com.apple.screencapture location ~/Pictures/Screenshots
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;killall SystemUIServer&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;and to test took a screen capture with CMD-SHIFT-3.&lt;/p&gt;

&lt;p&gt;I considered saving the screen captures to my Google Drive, but that
might prove to be a problem at some point down the road.&lt;/p&gt;

&lt;p&gt;Also, I’m using an app called &lt;a href=&quot;https://monosnap.com/welcome&quot;&gt;Monosnap&lt;/a&gt;
which is freely available from the App Store for making annotated
screen captures. I’m liking it a lot, it reminds me of Skitch for
Evernote, without the Evernote overhead.&lt;/p&gt;
</description>
        <pubDate>Tue, 02 May 2017 13:28:00 -0500</pubDate>
        <link>http://swaac.tamouse.org/osx/2017/05/02/changing-screencapture-location-on-macos/</link>
        <guid isPermaLink="true">http://swaac.tamouse.org/osx/2017/05/02/changing-screencapture-location-on-macos/</guid>
        
        <category>osx</category>
        
        <category>mac</category>
        
        <category>screencapture</category>
        
        <category>screenshot</category>
        
        <category>location</category>
        
        <category>defaults</category>
        
        
        <category>osx</category>
        
      </item>
    
      <item>
        <title>Resetting Emacs colours after working with Guard</title>
        <description>&lt;p&gt;This is a petty annoyance, but those add up.&lt;/p&gt;

&lt;p&gt;After I’ve been using &lt;a href=&quot;https://github/guard/guard&quot;&gt;guard&lt;/a&gt;, it leaves
the last status notification on my emacs mode line, so I want to reset
it so I can stop thinking about the project for a while.&lt;/p&gt;

&lt;p&gt;I found something like this and wrote it for my needs:&lt;/p&gt;

&lt;script src=&quot;https://gist.github.com/tamouse/4eaa00af7b415fc48ac03bcb97a4c2ac.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;I save the script in my &lt;code class=&quot;highlighter-rouge&quot;&gt;$HOME/bin/&lt;/code&gt; folder and can call it from the
command line to clean up my emacs mode line.&lt;/p&gt;
</description>
        <pubDate>Sat, 29 Apr 2017 16:01:00 -0500</pubDate>
        <link>http://swaac.tamouse.org/tools/2017/04/29/resetting-emacs-colours-after-working-with-guard/</link>
        <guid isPermaLink="true">http://swaac.tamouse.org/tools/2017/04/29/resetting-emacs-colours-after-working-with-guard/</guid>
        
        <category>emacs</category>
        
        <category>guard</category>
        
        <category>tools</category>
        
        <category>snippet</category>
        
        <category>gist</category>
        
        
        <category>tools</category>
        
      </item>
    
      <item>
        <title>Specifying target=_blank on an anchor in a markdown document</title>
        <description>&lt;p&gt;Just a quick note so I don’t lose this:&lt;/p&gt;

&lt;p&gt;In Jekyll’s default markdown processor, &lt;code class=&quot;highlighter-rouge&quot;&gt;kramdown&lt;/code&gt;, you can specify an
attribute on a spanning or block element inside braces (“squirly
brackets”) like so:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-markdown&quot; data-lang=&quot;markdown&quot;&gt;{:attr=&quot;value&quot;}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Thus, to get a link to open in a new tab:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-markdown&quot; data-lang=&quot;markdown&quot;&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;link text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;sx&quot;&gt;linkpath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;{:target=&quot;_blank&quot; rel=&quot;noopenner noreferrer&quot;}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Should generate:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;linkpath&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;target=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;_blank&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;link text&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let’s just see what happens:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href=&quot;/jekyll/2017/04/10/specifying-target-equals-blank-on-an-anchor-in-a-markdown-document/&quot; target=&quot;_blank&quot; rel=&quot;noopenner noreferrer&quot;&gt;This link&lt;/a&gt; should open in a new page.&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        <pubDate>Mon, 10 Apr 2017 00:46:00 -0500</pubDate>
        <link>http://swaac.tamouse.org/jekyll/2017/04/10/specifying-target-equals-blank-on-an-anchor-in-a-markdown-document/</link>
        <guid isPermaLink="true">http://swaac.tamouse.org/jekyll/2017/04/10/specifying-target-equals-blank-on-an-anchor-in-a-markdown-document/</guid>
        
        <category>markdown</category>
        
        <category>kramdown</category>
        
        <category>syntax</category>
        
        <category>target</category>
        
        <category>blank</category>
        
        <category>jekyll</category>
        
        
        <category>jekyll</category>
        
      </item>
    
      <item>
        <title>Link: Decorating ActiveRecord</title>
        <description>&lt;p&gt;This came across my path this
week: &lt;a href=&quot;https://robots.thoughtbot.com/authors/joel-quenneville&quot;&gt;Joël Quenneville&lt;/a&gt;’s
article,
&lt;a href=&quot;https://robots.thoughtbot.com/decorating-activerecord&quot;&gt;Decorating ActiveRecord&lt;/a&gt;,
which outlines some hazards when you go about decorating ActiveRecord
models.&lt;/p&gt;

&lt;p&gt;Do read the article, it’s good.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Here’s the tl;dr for my memory:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;If you’re decorating an ActiveRecord or ActiveModel object in Rails,
you probably want to define the following to ensure the decorator
works the way you expect instead of silently delegating to the
underlying object:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;


&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;table style=&quot;border-spacing: 0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot; style=&quot;text-align: right&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Profile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;SimpleDelegator&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Naming&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;to_model&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;


&lt;/blockquote&gt;
</description>
        <pubDate>Thu, 06 Apr 2017 23:01:00 -0500</pubDate>
        <link>http://swaac.tamouse.org/rails/2017/04/06/link-decorating-activerecord/</link>
        <guid isPermaLink="true">http://swaac.tamouse.org/rails/2017/04/06/link-decorating-activerecord/</guid>
        
        <category>rails</category>
        
        <category>activerecord</category>
        
        <category>decorators</category>
        
        <category>links</category>
        
        <category>tl-dr</category>
        
        
        <category>rails</category>
        
      </item>
    
      <item>
        <title>Baratunde Thurston Explains Web Encryption</title>
        <description>&lt;p&gt;The Electronic Freedom Foundation (&lt;a href=&quot;https://www.eff.org&quot; title=&quot;The Electronic Freedom Foundation&quot;&gt;EFF&lt;/a&gt;) is working
to &lt;a href=&quot;https://www.eff.org/encrypt-the-web&quot;&gt;encrypt the web&lt;/a&gt;, converting
all web sites from HTTP to
HTTPS. &lt;a href=&quot;http://baratunde.com/&quot;&gt;Baratunde Thurston&lt;/a&gt; narrates the video
explaining web encryption to the masses.&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/PdnpNJZVUE0?rel=0&quot; frameborder=&quot;0&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;You may notice my sites don’t use HTTPS. The only reason is I’ve not
gotten around to implementing it yet.&lt;/p&gt;

&lt;p&gt;I’ve used it on projects, and it’s pretty simple to set up. Look for a
future post, probably.&lt;/p&gt;
</description>
        <pubDate>Sun, 12 Feb 2017 08:06:00 -0600</pubDate>
        <link>http://swaac.tamouse.org/security/2017/02/12/baratunde-thurston-explains-web-encryption/</link>
        <guid isPermaLink="true">http://swaac.tamouse.org/security/2017/02/12/baratunde-thurston-explains-web-encryption/</guid>
        
        <category>security</category>
        
        <category>eff</category>
        
        <category>encryption</category>
        
        <category>https</category>
        
        <category>baratunde-thurston</category>
        
        
        <category>security</category>
        
      </item>
    
      <item>
        <title>How I Set Up my Local WordPress Development Environment Using Vagrant and Ansible</title>
        <description>&lt;p&gt;As part of my volunteering with &lt;a href=&quot;https://gdiminneapolis.com&quot; title=&quot;Girl, Develop it! Minneapolis Chapter&quot;&gt;GDI Minneapolis&lt;/a&gt;, I’ve been
getting back into WordPress development (child themes, custom themes,
etc.), while TAing, teaching, and helping develop some classes. One of
the key things we want to show students is how to develop their sites
safely and learn the trade of software development in the WordPress
environment.&lt;/p&gt;

&lt;p&gt;There are several ways one can do this. There are some really
&lt;em&gt;excellent&lt;/em&gt; tools out there now that make this a snap for people not
versed in setting things up themselves.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://local.getflywheel.com&quot; title=&quot;Local by Flywheel: Local WordPress development made simple&quot;&gt;Local by Flywheel&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://serverpress.com/get-desktopserver/&quot; title=&quot;Get DesktopServer and save time!&quot;&gt;DesktopServer from ServerPress&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;There are also traditional ways of installing &lt;a href=&quot;https://www.mamp.info/en/&quot; title=&quot;My Apache, MySQL, and PHP&quot;&gt;MAMP&lt;/a&gt; on MacOSx, or using
a &lt;a href=&quot;https://www.turnkeylinux.org/wordpress&quot; title=&quot;Turnkey Linux WordPress Appliance&quot;&gt;Turnkey Linux WordPress Appliance&lt;/a&gt;, and so many other ways.&lt;/p&gt;

&lt;p&gt;This is how I set up my local environment using two tools I use
heavily in other areas of web development:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.vagrantup.com/&quot; title=&quot;Development environments made easy&quot;&gt;Vagrant&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.ansible.com/&quot; title=&quot;Automation for everyone&quot;&gt;Ansible&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;First off, this is going to be less of a tutorial and more a
description of what I’m doing. I’m definitely not holding this out as
a definitive way to set up your local WordPress development
environment, but &lt;em&gt;my&lt;/em&gt; way that works for me. If you’re brand new to
all this, and don’t want to learn all about systems and devops, then I
recommend using one of the first two options above. (I’ve played a bit
with &lt;a href=&quot;https://local.getflywheel.com&quot; title=&quot;Local by Flywheel: Local WordPress development made simple&quot;&gt;Local&lt;/a&gt;, and find it amazingly intuitive and
simple, so that’s my latest recommendation.)&lt;/p&gt;

&lt;p&gt;Secondly, the sandbox setup is available on GitHub
at
&lt;a href=&quot;https://github.com/tamouse/sandbox.wp.local&quot;&gt;github.com/tamouse/sandbox.wp.local&lt;/a&gt; so
feel free to fork it, and do what you want with it. I’ll happily take
PRs if you find bugs, too.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;starting-point&quot;&gt;Starting Point&lt;/h2&gt;

&lt;p&gt;My working system:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Macbook Pro 13”&lt;/li&gt;
  &lt;li&gt;8 GiB RAM&lt;/li&gt;
  &lt;li&gt;4 CPU Cores&lt;/li&gt;
  &lt;li&gt;about 50 GiB free disk space (I didn’t need anywhere near this, it’s
just what was there when I started.)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;prerequisites&quot;&gt;Prerequisites&lt;/h2&gt;

&lt;h3 id=&quot;available-software&quot;&gt;Available Software&lt;/h3&gt;

&lt;p&gt;This is stuff I already had on my system because of other development
I do.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;HomeBrew&lt;/li&gt;
  &lt;li&gt;VirtualBox&lt;/li&gt;
  &lt;li&gt;Vagrant&lt;/li&gt;
  &lt;li&gt;Ansible&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;steps-to-get-things-set-up&quot;&gt;Steps to Get Things Set Up&lt;/h2&gt;

&lt;h3 id=&quot;create-a-project-folder-and-initialize-it&quot;&gt;Create a project folder and initialize it&lt;/h3&gt;

&lt;p&gt;I always start my projects the same way:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mkdir -p ~/Projects/wordpress-stuff/sandbox.wp.local
cd ~/Projects/wordpress-stuff/sandbox.wp.local
git init
echo 'Local WordPress Development Sandbox running in Vagrant with Ansible Provisioning' | tee README.md &amp;gt; .git/description
hub create -d &quot;$(cat .git/description)&quot;
git add -Av
git commit -m 'initial commit'
git push -u origin master
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;(Truth be told, this is one of my bash functions, so it really looked
like this:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;new_proj sandbox.wp.local 'Local WordPress Development Sandbox running in Vagrant with Ansible Provisioning' 'initial commit'
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;)&lt;/p&gt;

&lt;h3 id=&quot;run-vagrant-init&quot;&gt;Run &lt;code class=&quot;highlighter-rouge&quot;&gt;vagrant init&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;I typically use one of the later Ubuntu server variants; mostly I’ve
been using ‘trusty’:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant init &lt;span class=&quot;s1&quot;&gt;'ubuntu/trusty64'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;This writes out a default &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt; (which is written in Ruby).&lt;/p&gt;

&lt;h3 id=&quot;modify-vagrantfile-for-my-needs&quot;&gt;Modify &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt; for my needs&lt;/h3&gt;

&lt;p&gt;I modify the file so it looks like so:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;table style=&quot;border-spacing: 0&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot; style=&quot;text-align: right&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;no&quot;&gt;BOX_NAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sandbox.wp.local&quot;&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;DEFAULT_IP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;192.168.33.35&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;resolv&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;my_ip&lt;/span&gt;
  &lt;span class=&quot;vi&quot;&gt;@my_ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Resolv&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Hosts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;getaddress&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BOX_NAME&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;DEFAULT_IP&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;rescue&lt;/span&gt;
  &lt;span class=&quot;vi&quot;&gt;@my_ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;DEFAULT_IP&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Vagrant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ssh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;forward_agent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:sandbox_wp&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;box&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ubuntu/trusty64&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;network&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&quot;private_network&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;ip: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my_ip&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;network&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&quot;forwarded_port&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;guest: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;host: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8088&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;hostname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;BOX_NAME&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;provider&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;virtualbox&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# Display the VirtualBox GUI when booting the machine&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# vb.gui = true&lt;/span&gt;

      &lt;span class=&quot;c1&quot;&gt;# Customize the amount of memory on the VM:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;customize&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;modifyvm&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;--memory&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;2048&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;customize&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;modifyvm&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;--vram&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;18&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;customize&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;modifyvm&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;--cpus&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;customize&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;modifyvm&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;--natdnshostresolver1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;on&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;provision&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:ansible&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;playbook&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'ansible/sandbox.yml'&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# a.verbose  = 'vvvv'&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Some explanation about the various settings:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;BOX_NAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;sandbox.wp.local&quot;&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;DEFAULT_IP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;192.168.33.35&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;These define two constants that get used later in the &lt;code class=&quot;highlighter-rouge&quot;&gt;Vagrantfile&lt;/code&gt;. I
edited my machine’s &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/hosts&lt;/code&gt; file, which maps IP addresses to
hostnames locally. The line I added to &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/hosts&lt;/code&gt; looks like so:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;192.168.33.35	sandbox.wp.local sandbox
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;This lets me type ‘http://sandbox/’ or ‘http://sandbox.wp.local’ in
the browser address bar to access the web server that will be running
in the Vagrant Virtual Machine (aka “VM”).&lt;/p&gt;

&lt;p&gt;(Note: when I used &lt;a href=&quot;https://local.getflywheel.com&quot; title=&quot;Local by Flywheel: Local WordPress development made simple&quot;&gt;Local&lt;/a&gt;, it did something similar.)&lt;/p&gt;

&lt;p&gt;Then I’m bringing in ruby’s &lt;code class=&quot;highlighter-rouge&quot;&gt;resolv&lt;/code&gt; standard library, which gives the
ability to use that mapping given in the &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/hosts&lt;/code&gt; file; the
&lt;code class=&quot;highlighter-rouge&quot;&gt;DEFAULT_IP&lt;/code&gt; constant provides a fallback in case it can’t find
&lt;code class=&quot;highlighter-rouge&quot;&gt;BOX_NAME&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/hosts&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;my_ip&lt;/code&gt; method defined sets and returns the IP address to be used
for my WordPress sandbox.&lt;/p&gt;

&lt;p&gt;With all that handled, vagrant can begin it’s configuration. Most
everything from here out can be found in vagrant’s documentation, if
you want.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ssh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;forward_agent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;I set this to true so when I’m logged into the vagrant box, it will
use my ssh keys from my development machine; this is especially
helpful when using git commands that talk to GitHub, etc.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;network&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&quot;private_network&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;ip: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my_ip&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Here is where that calculation for figuring out what IP address to use
that matches the name ‘sandbox.wp.local’ I set up is made.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;n&quot;&gt;sb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;hostname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;BOX_NAME&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;This sets the VM host name, so it will match ‘sandbox.wp.local’ when
I’m logged in.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;      &lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;customize&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;modifyvm&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;--memory&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;2048&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;This reserves 2GiB of RAM for the VM.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;      &lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;customize&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;modifyvm&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;--vram&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;18&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;This reserves 18MB of RAM for the video buffer.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;      &lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;customize&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;modifyvm&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;--cpus&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;This allows up to 2 CPU Cores to be used by the VM.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;      &lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;customize&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;modifyvm&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;--natdnshostresolver1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;on&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;This does some magic to use the host machine’s DNS resolver to find
IP address, which pulls in the magic of mapping ‘sandbox.wp.local’.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;provision&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:ansible&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Tells vagrant I’m using Ansible provisioning.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;playbook&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'ansible/sandbox.yml'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Specifies the Ansible ‘playbook’&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;c1&quot;&gt;# a.verbose  = 'vvvv'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Leaving this commented out, but usually it’s uncommented for me to be
able to debug things during provisioning.&lt;/p&gt;

&lt;h3 id=&quot;make-a-git-savepoint&quot;&gt;Make a git savepoint&lt;/h3&gt;

&lt;p&gt;Committing the current changes at this point to create a “save point”
to get back to if I end up mucking things up.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git add -Av &amp;amp;&amp;amp; git commit -m 'Vagrantfile updated' &amp;amp;&amp;amp; git push
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;(And this is also a bash function:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gacp &lt;span class=&quot;s1&quot;&gt;'Vagrantfile updated'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;)&lt;/p&gt;

&lt;p&gt;At this point, I decided I would make a branch to work on Ansible
stuff, too:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git checkout -b ansible-playbook
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;create-the-anisble-playbook&quot;&gt;Create the Anisble Playbook&lt;/h3&gt;

&lt;p&gt;Ansible playbooks are build as YAML files, which is just a way of
specifying structured data. It’s akin to JSON and XML.&lt;/p&gt;

&lt;p&gt;I made the ansible playbook in the &lt;code class=&quot;highlighter-rouge&quot;&gt;ansible&lt;/code&gt; subdirectory, the
structure is:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ansible/
  group_vars/
    all.yml
  roles/
    external/
	  .keep
	internal/
	  cleanup/
	    tasks/
		  main.yml
	  common/
	    tasks/
		  install.yml
		  main.yml
	requirements.yml
  sandbox.yml
  sudo_roles.yml
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;top-level-playbook&quot;&gt;Top level playbook&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/tamouse/sandbox.wp.local/blob/master/ansible/sandbox.yml&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sandbox.yml&lt;/code&gt;&lt;/a&gt; is
the top-level playbook that sets the whole provisioning activity
off. It is simple and just contains:&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;sudo_roles.yml&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;sudo-roles-playbook&quot;&gt;Sudo Roles Playbook&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/tamouse/sandbox.wp.local/blob/master/ansible/sudo_roles.yml&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sudo_roles.yml&lt;/code&gt;&lt;/a&gt; is
the playbook that runs all the roles that need to be performs as the
superuser. In this project, that’s all of them. My playbook goes in
the following order:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;internal/common&lt;/li&gt;
  &lt;li&gt;external/calebwoods.brightbox_ruby&lt;/li&gt;
  &lt;li&gt;external/geerlingguy.nodejs&lt;/li&gt;
  &lt;li&gt;external/geerlingguy.apache&lt;/li&gt;
  &lt;li&gt;external/geerlingguy.mysql&lt;/li&gt;
  &lt;li&gt;external/geerlingguy.php&lt;/li&gt;
  &lt;li&gt;external/darthwade.wordpress&lt;/li&gt;
  &lt;li&gt;external/darthwade.wordpress-apache&lt;/li&gt;
  &lt;li&gt;internal/cleanup&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;defining-external-requirements&quot;&gt;Defining External Requirements&lt;/h3&gt;

&lt;p&gt;In building this up, my starting point was to figure out what
pre-built roles I could use to install the software and
configurations I would need. These filled out
&lt;a href=&quot;https://github.com/tamouse/sandbox.wp.local/blob/master/ansible/roles/requirements.yml&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;roles/requirements.yml&lt;/code&gt;&lt;/a&gt;. I’m using these roles:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/geerlingguy/nodejs/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;geerlingguy.nodejs&lt;/code&gt;&lt;/a&gt; - installs the latest stable version of Node.js&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/geerlingguy/apache/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;geerlingguy.apache&lt;/code&gt;&lt;/a&gt; - the Apache 2.x web server&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/geerlingguy/mysql/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;geerlingguy.mysql&lt;/code&gt;&lt;/a&gt; - MySQL database management system, 5.x&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/geerlingguy/php/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;geerlingguy.php&lt;/code&gt;&lt;/a&gt; - PHP language, 5.x&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/darthwade/wordpress/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;darthwade.wordpress&lt;/code&gt;&lt;/a&gt; - WordPress installation&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/darthwade/wordpress-apache/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;darthwade.wordpress-apache&lt;/code&gt;&lt;/a&gt; - Apache requirements for WordPress&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://galaxy.ansible.com/calebwoods/brightbox_ruby/&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;calebwoods.brightbox_ruby&lt;/code&gt;&lt;/a&gt; - Ruby 2.x because I like working in
Ruby, too&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Each of these requires some configuration. The configuration settings
are defined
in
&lt;a href=&quot;https://github.com/tamouse/sandbox.wp.local/blob/master/ansible/group_vars/all.yml&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;group_vars/all.yml&lt;/code&gt;&lt;/a&gt;. I
set things up as follows:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;enable apache &lt;code class=&quot;highlighter-rouge&quot;&gt;rewrite_mod&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;MySQL root password&lt;/li&gt;
  &lt;li&gt;MySQL WordPress database and user &lt;code class=&quot;highlighter-rouge&quot;&gt;vagrant&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Ruby version 2.2 and 2.3&lt;/li&gt;
  &lt;li&gt;Node.js version 6, npm user &lt;code class=&quot;highlighter-rouge&quot;&gt;vagrant&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Various PHP options and modules:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;php5&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;php5-cli&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;php5-common&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;php5-curl&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;php5-dev&lt;/code&gt;,
&lt;code class=&quot;highlighter-rouge&quot;&gt;php5-gd&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;php5-mysql&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;memory limit: 128MiB&lt;/li&gt;
      &lt;li&gt;execution time: 90s&lt;/li&gt;
      &lt;li&gt;max file upload size: 256MiB&lt;/li&gt;
      &lt;li&gt;disable apcu&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;WordPress Configurations&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;version 4.0&lt;/li&gt;
      &lt;li&gt;install directory &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/www/sandbox_wp&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;db user: &lt;code class=&quot;highlighter-rouge&quot;&gt;vagrant&lt;/code&gt; (match above)&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;db host: &lt;code class=&quot;highlighter-rouge&quot;&gt;localhost&lt;/code&gt;&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;hostname: &lt;code class=&quot;highlighter-rouge&quot;&gt;sandbox.wp.local&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;alias: ‘sandbox’&lt;/li&gt;
      &lt;li&gt;admin email: “admin@example.com” (because I’m not sending any
emails)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;internal-requirements&quot;&gt;Internal Requirements&lt;/h3&gt;

&lt;p&gt;These are things I installed and configured myself without relying on
pre-defined roles.&lt;/p&gt;

&lt;p&gt;Because the &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo_roles.yml&lt;/code&gt; file calls &lt;code class=&quot;highlighter-rouge&quot;&gt;internal/common&lt;/code&gt;,
&lt;code class=&quot;highlighter-rouge&quot;&gt;roles/internal/common/tasks/main.yml&lt;/code&gt; gets run automatically during
provisioning. It calls
in
&lt;a href=&quot;https://github.com/tamouse/sandbox.wp.local/blob/master/ansible/roles/internal/common/tasks/install.yml&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;roles/internal/common/tasks/install.yml&lt;/code&gt;&lt;/a&gt; which
I’m using to install necessary software packages.&lt;/p&gt;

&lt;p&gt;After updating the APT caches, I installed:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;build-essential&lt;/li&gt;
  &lt;li&gt;ntp&lt;/li&gt;
  &lt;li&gt;git&lt;/li&gt;
  &lt;li&gt;vim&lt;/li&gt;
  &lt;li&gt;emacs24&lt;/li&gt;
  &lt;li&gt;unzip&lt;/li&gt;
  &lt;li&gt;imagemagick&lt;/li&gt;
  &lt;li&gt;libmagick-dev&lt;/li&gt;
  &lt;li&gt;libxml2&lt;/li&gt;
  &lt;li&gt;libxml2-dev&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;WordPress definitely doesn’t need all of these, but my development
tools and workflow generally do, and that’s what this is all about.&lt;/p&gt;

&lt;h3 id=&quot;final-configuration-and-cleanup&quot;&gt;Final configuration and cleanup&lt;/h3&gt;

&lt;p&gt;After installing all the internal and external roles, I still had some
things I wanted to configure and clean up. These went
into
&lt;a href=&quot;https://github.com/tamouse/sandbox.wp.local/blob/master/ansible/roles/internal/cleanup/tasks/main.yml&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;roles/internal/cleanup/tasks/main.yml&lt;/code&gt;&lt;/a&gt; and
included:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;enabling the VHosts module for Apache2&lt;/li&gt;
  &lt;li&gt;disable the default and vhosts sites&lt;/li&gt;
  &lt;li&gt;reset user and group ownership of the WordPress site to &lt;code class=&quot;highlighter-rouge&quot;&gt;www-data&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;use the &lt;code class=&quot;highlighter-rouge&quot;&gt;direct&lt;/code&gt; method for &lt;code class=&quot;highlighter-rouge&quot;&gt;FS_METHOD&lt;/code&gt; which lets the WordPress
installation directly update from the codex without using FTP.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;another-git-save-point&quot;&gt;Another Git Save Point&lt;/h3&gt;

&lt;p&gt;Yep. This is how I roll.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gacp &lt;span class=&quot;s1&quot;&gt;'Ansible Playbook Created'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;gathering-the-external-requirements&quot;&gt;Gathering the External Requirements&lt;/h3&gt;

&lt;p&gt;Specifying the external requirements is not enough, I needed to tell
ansible to fetch them.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ansible-galaxy install -r ansible/roles/requirements.yml --force --ignore-errors
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;bringing-up-the-vm-and-first-provisioning&quot;&gt;Bringing up the VM and first provisioning&lt;/h3&gt;

&lt;p&gt;Now I was ready to pull together all the prior stuff and build the
box.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant up
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;The first time you run &lt;code class=&quot;highlighter-rouge&quot;&gt;up&lt;/code&gt; vagrant will start running the
provisioning after the box comes up. After this first time, however,
when you run the &lt;code class=&quot;highlighter-rouge&quot;&gt;up&lt;/code&gt; command, vagrant doesn’t try to
reprovision.&lt;/p&gt;

&lt;p&gt;So, you know, the first time you try something, you mistype something,
or you forget a configuration value, and so on. I know I did. I don’t
recall the specifics, but it doesn’t really matter, trial and error,
get things working, figure stuff out, and eventually I ended up with a
clean provisioning.&lt;/p&gt;

&lt;p&gt;You don’t need to keep running the &lt;code class=&quot;highlighter-rouge&quot;&gt;up&lt;/code&gt; command, you run the
&lt;code class=&quot;highlighter-rouge&quot;&gt;provision&lt;/code&gt; command instead while the box stays up. Since the point of
ansible is to provide an “idempotent” (i.e. same result each time
it’s run) solution, it will check if it’s successfully run a step and
skip over it. So my provisioning actually looked something like:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant up
&lt;span class=&quot;c&quot;&gt;# something broke, fix it&lt;/span&gt;
vagrant provision
&lt;span class=&quot;c&quot;&gt;# something broke, fix it&lt;/span&gt;
vagrant provision
&lt;span class=&quot;c&quot;&gt;# something broke, fix it&lt;/span&gt;
vagrant provision
&lt;span class=&quot;c&quot;&gt;# something broke, fix it&lt;/span&gt;
vagrant provision
&lt;span class=&quot;c&quot;&gt;# and so on&lt;/span&gt;
vagrant provision
&lt;span class=&quot;c&quot;&gt;# yay it finally worked!&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;and-another-save-point-and-merge-back-to-master&quot;&gt;And another save point, and merge back to master&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gacp 'Anisble provisioning works! Yay!`
git checkout master # aliased to: gco master
git merge ansible-playbook
gacp 'Merging ansible-playbook to master'
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Whew!&lt;/p&gt;

&lt;h3 id=&quot;set-up-wordpress-installation&quot;&gt;Set up WordPress Installation&lt;/h3&gt;

&lt;p&gt;I was now ready to give the WordPress five-minute installation a go. I
fired up my browser at &lt;code class=&quot;highlighter-rouge&quot;&gt;http://sandbox.wp.local&lt;/code&gt; and there was the
installation page, just as I’d hoped.&lt;/p&gt;

&lt;p&gt;After running through that, playing with appearance, plugins, making a
couple posts and pages, I was feeling good.&lt;/p&gt;

&lt;p&gt;I tried installing some themes and plugins from the WordPress codex,
and they installed nicely. Updated the WordPress installation itself,
and everything was great.&lt;/p&gt;

&lt;h2 id=&quot;creating-a-development-environment&quot;&gt;Creating a development environment&lt;/h2&gt;

&lt;p&gt;This is really the whole point of this exercise: I wanted a sandbox
that would let me develop child and custom themes, plugins, other
custom things as I wanted, using my local machine to edit things, and
apply my favourite tools including Sass, gulp, ruby, and so on.&lt;/p&gt;

&lt;p&gt;With the WordPress install running in &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/www/sandbox_wp&lt;/code&gt; under
&lt;code class=&quot;highlighter-rouge&quot;&gt;www-data&lt;/code&gt;, I still needed a way to be able to edit files locally and
have them show up under the WordPress site.&lt;/p&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;wp-content&lt;/code&gt; folder is used for a few things, but most important
to this task, I wanted to be able to have themes and plugins available
for local editing.&lt;/p&gt;

&lt;p&gt;Logging into the VM, I created a folder &lt;code class=&quot;highlighter-rouge&quot;&gt;/vagrant/dev&lt;/code&gt;, which would
show up on the local machine in the project root as just &lt;code class=&quot;highlighter-rouge&quot;&gt;dev/&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mkdir /vagrant/dev
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then I recursively copied the contents of
&lt;code class=&quot;highlighter-rouge&quot;&gt;/var/www/sandbox_wp/wp-content/themes&lt;/code&gt; and
&lt;code class=&quot;highlighter-rouge&quot;&gt;/var/www/sandbox_wp/wp-content/plugins&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;/vagrant/dev/&lt;/code&gt;, which
created two folders &lt;code class=&quot;highlighter-rouge&quot;&gt;/vagrant/dev/themes&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;/vagrant/dev/plugins&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cp -r /var/www/sandbox_wp/wp-content/themes /vagrant/dev
cp -r /var/www/sandbox_wp/wp-content/plugins /vagrant/dev
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;creating-a-little-demo-custom-theme&quot;&gt;Creating a little demo custom theme&lt;/h3&gt;

&lt;p&gt;To test things out, I created a custom theme under &lt;code class=&quot;highlighter-rouge&quot;&gt;dev/&lt;/code&gt; on the local
machine, and filled with some bare-bones content:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mkdir -p dev/themes/demo
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;The
&lt;a href=&quot;https://github.com/tamouse/sandbox.wp.local/tree/master/dev/themes/demo&quot;&gt;demo content&lt;/a&gt; was
pretty complicated to set up, and I’m not going into it here. Easier
would have been just making a child theme to try stuff out.&lt;/p&gt;

&lt;h3 id=&quot;telling-wordpress-about-the-custom-theme&quot;&gt;Telling WordPress about the Custom Theme&lt;/h3&gt;

&lt;p&gt;Back over on the VM, I needed to tell the WordPress installation about
this new custom theme:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/www/sandbox_wp/wp-content/themes
sudo ln -s /vagrant/dev/themes/demo .
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Popping back over to the browser, and pulling up the Appearances -&amp;gt;
Themes menu, lo and behold, the custom theme now showed up.&lt;/p&gt;

&lt;h2 id=&quot;the-development-workflow&quot;&gt;The development workflow&lt;/h2&gt;

&lt;p&gt;I now could edit files comfortably in my local editor of choice,
saving files, and view the results by refreshing the browser pointing
at the WordPress site running in the VM.&lt;/p&gt;

&lt;h2 id=&quot;final-thoughts&quot;&gt;Final Thoughts&lt;/h2&gt;

&lt;p&gt;I created this set up initially during &lt;a href=&quot;https://2016.minneapolis.wordcamp.org/&quot; title=&quot;WordCamp MSP 2016&quot;&gt;WordCamp MSP 2016&lt;/a&gt;
for the fundamentals day so I could have a local hacking spot without
trying to roll up a remote server or build up a local server that I
may not want to keep around.&lt;/p&gt;

&lt;p&gt;(This is why the demo custom theme is as complex as it is.)&lt;/p&gt;

&lt;p&gt;One of the excellent things about using Vagrant and Ansible is the
ease of which you can spin something up again if you want to. However,
for future WordPress development work, I will probably be going
with &lt;a href=&quot;https://local.getflywheel.com&quot; title=&quot;Local by Flywheel: Local WordPress development made simple&quot;&gt;Local&lt;/a&gt; because it is &lt;em&gt;such&lt;/em&gt; a slick product, and
that’s what I’m recommending to my WordPress students.&lt;/p&gt;

</description>
        <pubDate>Sat, 11 Feb 2017 22:17:00 -0600</pubDate>
        <link>http://swaac.tamouse.org/wordpress/2017/02/11/how-i-set-up-my-local-wordpress-development-environment-using-vagrant-and-ansible/</link>
        <guid isPermaLink="true">http://swaac.tamouse.org/wordpress/2017/02/11/how-i-set-up-my-local-wordpress-development-environment-using-vagrant-and-ansible/</guid>
        
        <category>wordpress</category>
        
        <category>vagrant</category>
        
        <category>ansible</category>
        
        <category>local</category>
        
        <category>sandbox</category>
        
        
        <category>wordpress</category>
        
      </item>
    
      <item>
        <title>Gitlab Database Outage Post-Mortem</title>
        <description>&lt;p&gt;Back at the end of January 2017, git SaaS
provider &lt;a href=&quot;https://gitlab.com&quot;&gt;Gitlab&lt;/a&gt; reported a disaster of epic
proportions:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;On January 31st 2017, we experienced a major service outage for one of our products, the online service GitLab.com. The outage was caused by an accidental removal of data from our primary database server.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;This incident caused the GitLab.com service to be unavailable for many hours. We also lost some production data that we were eventually unable to recover. Specifically, we lost modifications to database data such as projects, comments, user accounts, issues and snippets, that took place between 17:20 and 00:00 UTC on January 31. Our best estimate is that it affected roughly 5,000 projects, 5,000 comments and 700 new user accounts. Code repositories or wikis hosted on GitLab.com were unavailable during the outage, but were not affected by the data loss. GitLab Enterprise customers, GitHost customers, and self-hosted GitLab CE users were not affected by the outage, or the data loss.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;They had destroyed the database holding all their repository
information, and then could not find any viable backups.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Today, 11 February 2017,&lt;/strong&gt; they released
a &lt;a href=&quot;https://about.gitlab.com/2017/02/10/postmortem-of-database-outage-of-january-31/&quot;&gt;post-mortem&lt;/a&gt; of the situation,
providing something few companies have &lt;em&gt;ever&lt;/em&gt; done: transparency and
openness into a major devops disaster so that &lt;em&gt;everyone&lt;/em&gt; can learn.&lt;/p&gt;

&lt;p&gt;They list several items in the Root Cause Analysis section, and
provide a list of mitigation and recovery improvements now underway.&lt;/p&gt;

&lt;h2 id=&quot;major-kudos-to-gitlab&quot;&gt;Major kudos to Gitlab!&lt;/h2&gt;
</description>
        <pubDate>Sat, 11 Feb 2017 01:54:00 -0600</pubDate>
        <link>http://swaac.tamouse.org/devops/2017/02/11/gitlab-database-outage-post-mortem/</link>
        <guid isPermaLink="true">http://swaac.tamouse.org/devops/2017/02/11/gitlab-database-outage-post-mortem/</guid>
        
        <category>devops</category>
        
        <category>gitlab</category>
        
        <category>database-outage</category>
        
        <category>post-mortem</category>
        
        
        <category>devops</category>
        
      </item>
    
  </channel>
</rss>
<!-- touch 1 -->
